{"version":3,"file":"bs5-lightbox.js","sources":["../src/bs5-lightbox.ts"],"sourcesContent":["/**\n * Lightbox for Bootstrap 5\n *\n * @file Creates a modal with a lightbox carousel.\n * @module bs5-lightbox\n */\n\nimport * as bootstrap from \"bootstrap\";\nimport LightboxOptions from \"./interfaces/lightboxOptions\";\n\nclass Lightbox {\n  private hash: string;\n  private settings: LightboxOptions;\n  private modalOptions: bootstrap.Modal.Options;\n  private carouselOptions: bootstrap.Carousel.Options;\n  private el: HTMLElement;\n  private src: string;\n  private sources: string[];\n  private type: string;\n  private carouselElement!: HTMLElement;\n  private modalElement!: HTMLElement;\n  private modal!: bootstrap.Modal;\n  private carousel!: bootstrap.Carousel;\n\n  static allowedEmbedTypes = [\"embed\", \"youtube\", \"vimeo\", \"instagram\", \"url\"];\n  static allowedMediaTypes = [...Lightbox.allowedEmbedTypes, \"image\", \"html\"];\n  static defaultSelector = '[data-toggle=\"lightbox\"]';\n\n  constructor(\n    el: HTMLElement | string,\n    options: Partial<LightboxOptions> = {},\n  ) {\n    this.hash = this.randomHash();\n    this.settings = Object.assign(\n      {},\n      bootstrap.Modal.Default,\n      bootstrap.Carousel.Default,\n      {\n        interval: false,\n        target: '[data-toggle=\"lightbox\"]',\n        gallery: \"\",\n        size: \"xl\",\n        constrain: true,\n      },\n      options,\n    );\n\n    this.modalOptions = this.setOptionsFromSettings(bootstrap.Modal.Default);\n    this.carouselOptions = this.setOptionsFromSettings(\n      bootstrap.Carousel.Default,\n    );\n\n    if (typeof el === \"string\") {\n      this.settings.target = el;\n      el = document.querySelector(el) as HTMLElement;\n    }\n\n    this.el = el;\n    this.type = el.dataset.type || \"\";\n\n    if (el.dataset.size) {\n      this.settings.size = el.dataset.size;\n    }\n\n    this.src = this.getSrc(el);\n    this.sources = this.getGalleryItems();\n    this.createCarousel();\n    this.createModal();\n  }\n\n  show(): void {\n    document.body.appendChild(this.modalElement);\n    this.modal.show();\n  }\n\n  hide(): void {\n    this.modal.hide();\n  }\n\n  private setOptionsFromSettings(obj: any): any {\n    return Object.keys(obj).reduce(\n      (p: any, c: string) => Object.assign(p, { [c]: this.settings[c] }),\n      {},\n    );\n  }\n\n  private getSrc(el: HTMLElement): string {\n    let src =\n      el.dataset.src ||\n      el.dataset.remote ||\n      (el as HTMLAnchorElement).href ||\n      \"https://placehold.co/1600x900\";\n\n    if (el.dataset.type === \"html\" || el.dataset.type === \"image\") {\n      return src;\n    }\n\n    if (!/https?:\\/\\//.test(src)) {\n      src = window.location.origin + src;\n    }\n\n    const url = new URL(src);\n    if (el.dataset.footer || el.dataset.caption) {\n      url.searchParams.set(\n        \"caption\",\n        el.dataset.footer || el.dataset.caption || \"\",\n      );\n    }\n\n    return url.toString();\n  }\n\n  private getGalleryItems(): string[] {\n    let galleryTarget: string | undefined;\n\n    if (this.settings.gallery) {\n      if (Array.isArray(this.settings.gallery)) return this.settings.gallery;\n      galleryTarget = this.settings.gallery;\n    } else if (this.el.dataset.gallery) {\n      galleryTarget = this.el.dataset.gallery;\n    }\n\n    const gallery = galleryTarget\n      ? [\n          ...new Set(\n            Array.from(\n              document.querySelectorAll(`[data-gallery=\"${galleryTarget}\"]`),\n              (v: Element) => {\n                const el = v as HTMLElement;\n                return `${el.dataset.type || \"\"}${this.getSrc(el)}`;\n              },\n            ),\n          ),\n        ]\n      : [`${this.type || \"\"}${this.src}`];\n\n    return gallery;\n  }\n\n  private getYoutubeId(src: string): string | false {\n    const matches = src.match(\n      /^.*(youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|&v=)([^#&?]*).*/,\n    );\n    return matches && matches[2].length === 11 ? matches[2] : false;\n  }\n\n  private getYoutubeLink(src: string): string | false {\n    const youtubeId = this.getYoutubeId(src);\n    if (!youtubeId) return false;\n\n    const arr = src.split(\"?\");\n    const params = arr.length > 1 ? `?${arr[1]}` : \"\";\n\n    return `https://www.youtube.com/embed/${youtubeId}${params}`;\n  }\n\n  private getInstagramEmbed(src: string): string | undefined {\n    if (/instagram/.test(src)) {\n      src += /\\/embed$/.test(src) ? \"\" : \"/embed\";\n      return `<iframe src=\"${src}\" class=\"start-50 translate-middle-x\" style=\"max-width: 500px\" frameborder=\"0\" scrolling=\"no\" allowtransparency=\"true\"></iframe>`;\n    }\n  }\n\n  private isEmbed(src: string): boolean {\n    const regex = new RegExp(`(${Lightbox.allowedEmbedTypes.join(\"|\")})`);\n    const isEmbed = regex.test(src);\n    const isImg =\n      /\\.(png|jpe?g|gif|svg|webp)/i.test(src) ||\n      this.el.dataset.type === \"image\";\n\n    return isEmbed || !isImg;\n  }\n\n  private createCarousel(): bootstrap.Carousel {\n    const template = document.createElement(\"template\");\n    const types = Lightbox.allowedMediaTypes.join(\"|\");\n\n    const slidesHtml = this.sources\n      .map((src, i) => {\n        src = src.replace(/\\/$/, \"\");\n        const regex = new RegExp(`^(${types})`, \"i\");\n        const isHtml = /^html/.test(src);\n        const isForcedImage = /^image/.test(src);\n\n        if (regex.test(src)) {\n          src = src.replace(regex, \"\");\n        }\n\n        const imgClasses = this.settings.constrain\n          ? \"mw-100 mh-100 h-auto w-auto m-auto top-0 end-0 bottom-0 start-0\"\n          : \"h-100 w-100\";\n\n        const params = new URLSearchParams(src.split(\"?\")[1]);\n        let caption = \"\";\n        let url = src;\n\n        if (params.get(\"caption\")) {\n          try {\n            url = new URL(src).toString().replace(`?${params}`, \"\");\n            caption = `<div class=\"carousel-caption d-none d-md-block\" style=\"z-index:2\"><p class=\"bg-secondary rounded\">${params.get(\n              \"caption\",\n            )}</p></div>`;\n          } catch {\n            url = src;\n          }\n        }\n\n        let inner = `<img src=\"${url}\" class=\"d-block ${imgClasses} img-fluid\" style=\"z-index: 1; object-fit: contain;\" />`;\n        let attributes = \"\";\n        const instagramEmbed = this.getInstagramEmbed(src);\n        const youtubeLink = this.getYoutubeLink(src);\n\n        if (this.isEmbed(src) && !isForcedImage) {\n          if (youtubeLink) {\n            src = youtubeLink;\n            attributes =\n              'title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer autoplay clipboard-write encrypted-media gyroscope picture-in-picture\"';\n          }\n          inner =\n            instagramEmbed ||\n            `<img src=\"${src}\" ${attributes} class=\"d-block mw-100 mh-100 h-auto w-auto m-auto top-0 end-0 bottom-0 start-0 img-fluid\" style=\"z-index: 1; object-fit: contain;\" />`;\n        }\n\n        if (isHtml) {\n          inner = src;\n        }\n\n        const spinner = `<div class=\"position-absolute top-50 start-50 translate-middle text-white\"><div class=\"spinner-border\" style=\"width: 3rem; height: 3rem\" role=\"status\"></div></div>`;\n\n        return `\n          <div class=\"carousel-item ${\n            !i ? \"active\" : \"\"\n          }\" style=\"min-height: 100px\">\n            ${spinner}\n            <div class=\"ratio ratio-16x9\" style=\"background-color: #000;\">${inner}</div>\n            ${caption}\n          </div>`;\n      })\n      .join(\"\");\n\n    const controlsHtml =\n      this.sources.length < 2\n        ? \"\"\n        : `\n        <button id=\"#lightboxCarousel-${this.hash}-prev\" class=\"carousel-control-prev\" type=\"button\" data-bs-target=\"#lightboxCarousel-${this.hash}\" data-bs-slide=\"prev\">\n          <span class=\"btn btn-primary carousel-control-prev-icon\" aria-hidden=\"true\"></span>\n          <span class=\"visually-hidden\">Previous</span>\n        </button>\n        <button id=\"#lightboxCarousel-${this.hash}-next\" class=\"carousel-control-next\" type=\"button\" data-bs-target=\"#lightboxCarousel-${this.hash}\" data-bs-slide=\"next\">\n          <span class=\"btn btn-primary carousel-control-next-icon\" aria-hidden=\"true\"></span>\n          <span class=\"visually-hidden\">Next</span>\n        </button>`;\n\n    const indicatorsHtml = `\n      <div class=\"carousel-indicators\" style=\"bottom: -40px\">\n        ${this.sources\n          .map(\n            (_, index) => `\n            <button type=\"button\" data-bs-target=\"#lightboxCarousel-${\n              this.hash\n            }\" data-bs-slide-to=\"${index}\" class=\"${\n              index === 0 ? \"active\" : \"\"\n            }\" aria-current=\"${\n              index === 0 ? \"true\" : \"false\"\n            }\" aria-label=\"Slide ${index + 1}\"></button>`,\n          )\n          .join(\"\")}\n      </div>`;\n\n    template.innerHTML = `\n      <div id=\"lightboxCarousel-${this.hash}\" class=\"lightbox-carousel carousel slide\" data-bs-ride=\"carousel\" data-bs-interval=\"${this.carouselOptions.interval}\">\n        <div class=\"carousel-inner\">${slidesHtml}</div>\n        ${indicatorsHtml}\n        ${controlsHtml}\n      </div>`.trim();\n\n    this.carouselElement = template.content.firstChild as HTMLElement;\n\n    const options: bootstrap.Carousel.Options = {\n      ...this.carouselOptions,\n      keyboard: false,\n    };\n\n    this.carousel = new bootstrap.Carousel(this.carouselElement, options);\n\n    const elSrc =\n      this.type && this.type !== \"image\" ? this.type + this.src : this.src;\n    this.carousel.to(this.findGalleryItemIndex(this.sources, elSrc));\n\n    if (this.carouselOptions.keyboard === true) {\n      document.addEventListener(\"keydown\", (e: KeyboardEvent) => {\n        if (e.code === \"ArrowLeft\") {\n          document\n            .getElementById(`#lightboxCarousel-${this.hash}-prev`)\n            ?.click();\n          return false;\n        }\n        if (e.code === \"ArrowRight\") {\n          document\n            .getElementById(`#lightboxCarousel-${this.hash}-next`)\n            ?.click();\n          return false;\n        }\n      });\n    }\n\n    return this.carousel;\n  }\n\n  private findGalleryItemIndex(haystack: string[], needle: string): number {\n    return haystack.findIndex((item) => item.includes(needle)) || 0;\n  }\n\n  private createModal(): bootstrap.Modal {\n    const template = document.createElement(\"template\");\n    template.innerHTML = `\n      <div class=\"modal lightbox fade\" id=\"lightboxModal-${this.hash}\" tabindex=\"-1\">\n        <div class=\"modal-dialog modal-dialog-centered modal-${this.settings.size}\">\n          <div class=\"modal-content border-0 bg-transparent\">\n            <div class=\"modal-body p-0\">\n              <button type=\"button\" class=\"btn-close position-absolute p-3\" data-bs-dismiss=\"modal\" aria-label=\"Close\" style=\"top: -15px;right:-40px\"></button>\n            </div>\n          </div>\n        </div>\n      </div>`.trim();\n\n    this.modalElement = template.content.firstChild as HTMLElement;\n    this.modalElement\n      .querySelector(\".modal-body\")\n      ?.appendChild(this.carouselElement);\n\n    this.modalElement.addEventListener(\"hidden.bs.modal\", () =>\n      this.modalElement.remove(),\n    );\n    this.modalElement\n      .querySelector(\"[data-bs-dismiss]\")\n      ?.addEventListener(\"click\", () => this.modal.hide());\n\n    this.modal = new bootstrap.Modal(this.modalElement, this.modalOptions);\n    return this.modal;\n  }\n\n  private randomHash(length = 8): string {\n    return Array.from({ length }, () =>\n      Math.floor(Math.random() * 36).toString(36),\n    ).join(\"\");\n  }\n\n  static initialize(this: HTMLElement, e: Event): void {\n    e.preventDefault();\n    const lightbox = new Lightbox(this);\n    lightbox.show();\n  }\n}\n\ndocument\n  .querySelectorAll(Lightbox.defaultSelector)\n  .forEach((el) => el.addEventListener(\"click\", Lightbox.initialize));\n\nif (typeof window !== \"undefined\" && (window as any).bootstrap) {\n  (window as any).bootstrap.Lightbox = Lightbox;\n}\n\nexport default Lightbox;\n"],"names":["Lightbox","el","options","bootstrap","obj","p","c","src","url","galleryTarget","v","matches","youtubeId","arr","params","isEmbed","isImg","template","types","slidesHtml","i","regex","isHtml","isForcedImage","imgClasses","caption","inner","attributes","instagramEmbed","youtubeLink","controlsHtml","indicatorsHtml","_","index","elSrc","e","haystack","needle","item","length"],"mappings":"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"}