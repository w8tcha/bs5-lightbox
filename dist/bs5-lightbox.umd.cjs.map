{"version":3,"file":"bs5-lightbox.umd.cjs","sources":["../src/bs5-lightbox.ts"],"sourcesContent":["/**\r\n * Lightbox for Bootstrap 5\r\n *\r\n * @file Creates a modal with a lightbox carousel.\r\n * @module bs5-lightbox\r\n */\r\n\r\nimport * as bootstrap from \"bootstrap\";\r\nimport LightboxOptions from \"./interfaces/lightboxOptions\";\r\n\r\nclass Lightbox {\r\n  private hash: string;\r\n  private settings: LightboxOptions;\r\n  private modalOptions: bootstrap.Modal.Options;\r\n  private carouselOptions: bootstrap.Carousel.Options;\r\n  private el: HTMLElement;\r\n  private src: string;\r\n  private sources: string[];\r\n  private type: string;\r\n  private carouselElement!: HTMLElement;\r\n  private modalElement!: HTMLElement;\r\n  private modal!: bootstrap.Modal;\r\n  private carousel!: bootstrap.Carousel;\r\n\r\n  static allowedEmbedTypes = [\"embed\", \"youtube\", \"vimeo\", \"instagram\", \"url\"];\r\n  static allowedMediaTypes = [...Lightbox.allowedEmbedTypes, \"image\", \"html\"];\r\n  static defaultSelector = '[data-toggle=\"lightbox\"]';\r\n\r\n  constructor(\r\n    el: HTMLElement | string,\r\n    options: Partial<LightboxOptions> = {}\r\n  ) {\r\n    this.hash = this.randomHash();\r\n    this.settings = Object.assign(\r\n      {},\r\n      bootstrap.Modal.Default,\r\n      bootstrap.Carousel.Default,\r\n      {\r\n        interval: false,\r\n        target: '[data-toggle=\"lightbox\"]',\r\n        gallery: \"\",\r\n        size: \"xl\",\r\n        constrain: true,\r\n      },\r\n      options\r\n    );\r\n\r\n    this.modalOptions = this.setOptionsFromSettings(bootstrap.Modal.Default);\r\n    this.carouselOptions = this.setOptionsFromSettings(\r\n      bootstrap.Carousel.Default\r\n    );\r\n\r\n    if (typeof el === \"string\") {\r\n      this.settings.target = el;\r\n      el = document.querySelector(el) as HTMLElement;\r\n    }\r\n\r\n    this.el = el;\r\n    this.type = el.dataset.type || \"\";\r\n\r\n    if (el.dataset.size) {\r\n      this.settings.size = el.dataset.size;\r\n    }\r\n\r\n    this.src = this.getSrc(el);\r\n    this.sources = this.getGalleryItems();\r\n    this.createCarousel();\r\n    this.createModal();\r\n  }\r\n\r\n  show(): void {\r\n    document.body.appendChild(this.modalElement);\r\n    this.modal.show();\r\n  }\r\n\r\n  hide(): void {\r\n    this.modal.hide();\r\n  }\r\n\r\n  private setOptionsFromSettings(obj: any): any {\r\n    return Object.keys(obj).reduce(\r\n      (p: any, c: string) => Object.assign(p, { [c]: this.settings[c] }),\r\n      {}\r\n    );\r\n  }\r\n\r\n  private getSrc(el: HTMLElement): string {\r\n    let src =\r\n      el.dataset.src ||\r\n      el.dataset.remote ||\r\n      (el as HTMLAnchorElement).href ||\r\n      \"https://placehold.co/1600x900\";\r\n\r\n    if (el.dataset.type === \"html\" || el.dataset.type === \"image\") {\r\n      return src;\r\n    }\r\n\r\n    if (!/https?:\\/\\//.test(src)) {\r\n      src = window.location.origin + src;\r\n    }\r\n\r\n    const url = new URL(src);\r\n    if (el.dataset.footer || el.dataset.caption) {\r\n      url.searchParams.set(\r\n        \"caption\",\r\n        el.dataset.footer || el.dataset.caption || \"\"\r\n      );\r\n    }\r\n\r\n    return url.toString();\r\n  }\r\n\r\n  private getGalleryItems(): string[] {\r\n    let galleryTarget: string | undefined;\r\n\r\n    if (this.settings.gallery) {\r\n      if (Array.isArray(this.settings.gallery)) return this.settings.gallery;\r\n      galleryTarget = this.settings.gallery;\r\n    } else if (this.el.dataset.gallery) {\r\n      galleryTarget = this.el.dataset.gallery;\r\n    }\r\n\r\n    const gallery = galleryTarget\r\n      ? [\r\n          ...new Set(\r\n            Array.from(\r\n              document.querySelectorAll(`[data-gallery=\"${galleryTarget}\"]`),\r\n              (v: Element) => {\r\n                const el = v as HTMLElement;\r\n                return `${el.dataset.type || \"\"}${this.getSrc(el)}`;\r\n              }\r\n            )\r\n          ),\r\n        ]\r\n      : [`${this.type || \"\"}${this.src}`];\r\n\r\n    return gallery;\r\n  }\r\n\r\n  private getYoutubeId(src: string): string | false {\r\n    const matches = src.match(\r\n      /^.*(youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|&v=)([^#&?]*).*/\r\n    );\r\n    return matches && matches[2].length === 11 ? matches[2] : false;\r\n  }\r\n\r\n  private getYoutubeLink(src: string): string | false {\r\n    const youtubeId = this.getYoutubeId(src);\r\n    if (!youtubeId) return false;\r\n\r\n    const arr = src.split(\"?\");\r\n    const params = arr.length > 1 ? `?${arr[1]}` : \"\";\r\n\r\n    return `https://www.youtube.com/embed/${youtubeId}${params}`;\r\n  }\r\n\r\n  private getInstagramEmbed(src: string): string | undefined {\r\n    if (/instagram/.test(src)) {\r\n      src += /\\/embed$/.test(src) ? \"\" : \"/embed\";\r\n      return `<iframe src=\"${src}\" class=\"start-50 translate-middle-x\" style=\"max-width: 500px\" frameborder=\"0\" scrolling=\"no\" allowtransparency=\"true\"></iframe>`;\r\n    }\r\n  }\r\n\r\n  private isEmbed(src: string): boolean {\r\n    const regex = new RegExp(`(${Lightbox.allowedEmbedTypes.join(\"|\")})`);\r\n    const isEmbed = regex.test(src);\r\n    const isImg =\r\n      /\\.(png|jpe?g|gif|svg|webp)/i.test(src) ||\r\n      this.el.dataset.type === \"image\";\r\n\r\n    return isEmbed || !isImg;\r\n  }\r\n\r\n  private createCarousel(): bootstrap.Carousel {\r\n    const template = document.createElement(\"template\");\r\n    const types = Lightbox.allowedMediaTypes.join(\"|\");\r\n\r\n    const slidesHtml = this.sources\r\n      .map((src, i) => {\r\n        src = src.replace(/\\/$/, \"\");\r\n        const regex = new RegExp(`^(${types})`, \"i\");\r\n        const isHtml = /^html/.test(src);\r\n        const isForcedImage = /^image/.test(src);\r\n\r\n        if (regex.test(src)) {\r\n          src = src.replace(regex, \"\");\r\n        }\r\n\r\n        const imgClasses = this.settings.constrain\r\n          ? \"mw-100 mh-100 h-auto w-auto m-auto top-0 end-0 bottom-0 start-0\"\r\n          : \"h-100 w-100\";\r\n\r\n        const params = new URLSearchParams(src.split(\"?\")[1]);\r\n        let caption = \"\";\r\n        let url = src;\r\n\r\n        if (params.get(\"caption\")) {\r\n          try {\r\n            let urlCleaned = new URL(src);\r\n            urlCleaned.searchParams.delete(\"caption\");\r\n            url = urlCleaned.toString();\r\n\r\n            caption = `<div class=\"carousel-caption d-none d-md-block\" style=\"z-index:2\"><p class=\"bg-secondary rounded\">${params.get(\r\n              \"caption\"\r\n            )}</p></div>`;\r\n          } catch {\r\n            url = src;\r\n          }\r\n        }\r\n\r\n        let inner = `<img src=\"${url}\" class=\"d-block ${imgClasses} img-fluid\" style=\"z-index: 1; object-fit: contain;\" />`;\r\n        let attributes = \"\";\r\n        const instagramEmbed = this.getInstagramEmbed(src);\r\n        const youtubeLink = this.getYoutubeLink(src);\r\n\r\n        if (this.isEmbed(src) && !isForcedImage) {\r\n          if (youtubeLink) {\r\n            src = youtubeLink;\r\n            attributes =\r\n              'title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer autoplay clipboard-write encrypted-media gyroscope picture-in-picture\"';\r\n          }\r\n          inner =\r\n            instagramEmbed ||\r\n            `<img src=\"${src}\" ${attributes} class=\"d-block mw-100 mh-100 h-auto w-auto m-auto top-0 end-0 bottom-0 start-0 img-fluid\" style=\"z-index: 1; object-fit: contain;\" />`;\r\n        }\r\n\r\n        if (isHtml) {\r\n          inner = src;\r\n        }\r\n\r\n        const spinner = `<div class=\"position-absolute top-50 start-50 translate-middle text-white\"><div class=\"spinner-border\" style=\"width: 3rem; height: 3rem\" role=\"status\"></div></div>`;\r\n\r\n        return `\r\n          <div class=\"carousel-item ${\r\n            !i ? \"active\" : \"\"\r\n          }\" style=\"min-height: 100px\">\r\n            ${spinner}\r\n            <div class=\"ratio ratio-16x9\" style=\"background-color: #000;\">${inner}</div>\r\n            ${caption}\r\n          </div>`;\r\n      })\r\n      .join(\"\");\r\n\r\n    const controlsHtml =\r\n      this.sources.length < 2\r\n        ? \"\"\r\n        : `\r\n        <button id=\"#lightboxCarousel-${this.hash}-prev\" class=\"carousel-control-prev\" type=\"button\" data-bs-target=\"#lightboxCarousel-${this.hash}\" data-bs-slide=\"prev\">\r\n          <span class=\"btn btn-primary carousel-control-prev-icon\" aria-hidden=\"true\"></span>\r\n          <span class=\"visually-hidden\">Previous</span>\r\n        </button>\r\n        <button id=\"#lightboxCarousel-${this.hash}-next\" class=\"carousel-control-next\" type=\"button\" data-bs-target=\"#lightboxCarousel-${this.hash}\" data-bs-slide=\"next\">\r\n          <span class=\"btn btn-primary carousel-control-next-icon\" aria-hidden=\"true\"></span>\r\n          <span class=\"visually-hidden\">Next</span>\r\n        </button>`;\r\n\r\n    const indicatorsHtml = `\r\n      <div class=\"carousel-indicators\" style=\"bottom: -40px\">\r\n        ${this.sources\r\n          .map(\r\n            (_, index) => `\r\n            <button type=\"button\" data-bs-target=\"#lightboxCarousel-${\r\n              this.hash\r\n            }\" data-bs-slide-to=\"${index}\" class=\"${\r\n              index === 0 ? \"active\" : \"\"\r\n            }\" aria-current=\"${\r\n              index === 0 ? \"true\" : \"false\"\r\n            }\" aria-label=\"Slide ${index + 1}\"></button>`\r\n          )\r\n          .join(\"\")}\r\n      </div>`;\r\n\r\n    template.innerHTML = `\r\n      <div id=\"lightboxCarousel-${this.hash}\" class=\"lightbox-carousel carousel slide\" data-bs-ride=\"carousel\" data-bs-interval=\"${this.carouselOptions.interval}\">\r\n        <div class=\"carousel-inner\">${slidesHtml}</div>\r\n        ${indicatorsHtml}\r\n        ${controlsHtml}\r\n      </div>`.trim();\r\n\r\n    this.carouselElement = template.content.firstChild as HTMLElement;\r\n\r\n    const options: bootstrap.Carousel.Options = {\r\n      ...this.carouselOptions,\r\n      keyboard: false,\r\n    };\r\n\r\n    this.carousel = new bootstrap.Carousel(this.carouselElement, options);\r\n\r\n    const elSrc =\r\n      this.type && this.type !== \"image\" ? this.type + this.src : this.src;\r\n    this.carousel.to(this.findGalleryItemIndex(this.sources, elSrc));\r\n\r\n    if (this.carouselOptions.keyboard === true) {\r\n      document.addEventListener(\"keydown\", (e: KeyboardEvent) => {\r\n        if (e.code === \"ArrowLeft\") {\r\n          document\r\n            .getElementById(`#lightboxCarousel-${this.hash}-prev`)\r\n            ?.click();\r\n          return false;\r\n        }\r\n        if (e.code === \"ArrowRight\") {\r\n          document\r\n            .getElementById(`#lightboxCarousel-${this.hash}-next`)\r\n            ?.click();\r\n          return false;\r\n        }\r\n      });\r\n    }\r\n\r\n    return this.carousel;\r\n  }\r\n\r\n  private findGalleryItemIndex(haystack: string[], needle: string): number {\r\n    return haystack.findIndex((item) => item.includes(needle)) || 0;\r\n  }\r\n\r\n  private createModal(): bootstrap.Modal {\r\n    const template = document.createElement(\"template\");\r\n    template.innerHTML = `\r\n      <div class=\"modal lightbox fade\" id=\"lightboxModal-${this.hash}\" tabindex=\"-1\">\r\n        <div class=\"modal-dialog modal-dialog-centered modal-${this.settings.size}\">\r\n          <div class=\"modal-content border-0 bg-transparent\">\r\n            <div class=\"modal-body p-0\">\r\n              <button type=\"button\" class=\"btn-close position-absolute p-3\" data-bs-dismiss=\"modal\" aria-label=\"Close\" style=\"top: -15px;right:-40px\"></button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>`.trim();\r\n\r\n    this.modalElement = template.content.firstChild as HTMLElement;\r\n    this.modalElement\r\n      .querySelector(\".modal-body\")\r\n      ?.appendChild(this.carouselElement);\r\n\r\n    this.modalElement.addEventListener(\"hidden.bs.modal\", () =>\r\n      this.modalElement.remove()\r\n    );\r\n    this.modalElement\r\n      .querySelector(\"[data-bs-dismiss]\")\r\n      ?.addEventListener(\"click\", () => this.modal.hide());\r\n\r\n    this.modal = new bootstrap.Modal(this.modalElement, this.modalOptions);\r\n    return this.modal;\r\n  }\r\n\r\n  private randomHash(length = 8): string {\r\n    return Array.from({ length }, () =>\r\n      Math.floor(Math.random() * 36).toString(36)\r\n    ).join(\"\");\r\n  }\r\n\r\n  static initialize(this: HTMLElement, e: Event): void {\r\n    e.preventDefault();\r\n    const lightbox = new Lightbox(this);\r\n    lightbox.show();\r\n  }\r\n}\r\n\r\ndocument\r\n  .querySelectorAll(Lightbox.defaultSelector)\r\n  .forEach((el) => el.addEventListener(\"click\", Lightbox.initialize));\r\n\r\nif (typeof window !== \"undefined\" && (window as any).bootstrap) {\r\n  (window as any).bootstrap.Lightbox = Lightbox;\r\n}\r\n\r\nexport default Lightbox;\r\n"],"names":["Lightbox","el","options","bootstrap","obj","p","c","src","url","galleryTarget","v","matches","youtubeId","arr","params","isEmbed","isImg","template","types","slidesHtml","i","regex","isHtml","isForcedImage","imgClasses","caption","urlCleaned","inner","attributes","instagramEmbed","youtubeLink","controlsHtml","indicatorsHtml","_","index","elSrc","e","haystack","needle","item","length"],"mappings":"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"}